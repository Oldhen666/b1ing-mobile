<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>B1ing ‚Äì My Account</title>

  <!-- Google Identity Services -->
  <script src="https://accounts.google.com/gsi/client" async defer onload="initGoogleLogin()"></script>
  <!-- Facebook SDK -->
  <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js"></script>

  <style>
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
      background: #f5f5f7;
      color: #222;
    }

    .account-page {
      min-height: 100vh;
      background: linear-gradient(135deg, #ffb347, #ffcc33);
    }

    .account-inner {
      max-width: 480px;
      margin: 0 auto;
      padding-bottom: 72px;
    }

    /* È°∂ÈÉ®ËÉåÊôØ + Ê†áÈ¢ò */
    .account-header {
      padding: 48px 20px 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: #fff;
    }

    .account-title {
      font-size: 22px;
      font-weight: 700;
    }

    .account-subtitle {
      font-size: 13px;
      opacity: 0.9;
      margin-top: 4px;
    }

    .header-icons {
      display: flex;
      gap: 14px;
      font-size: 20px;
      opacity: 0.95;
    }

    /* ‰∏™‰∫∫‰ø°ÊÅØÂç°Áâá */
    .profile-card {
      background: #fff;
      border-radius: 22px;
      margin: 0 16px;
      padding: 16px 16px 12px;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.12);
      transform: translateY(-10px);
    }

    .profile-header {
      display: flex;
      align-items: center;
    }

    .avatar {
      width: 54px;
      height: 54px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ff9966, #ff5e62);
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 26px;
      font-weight: 700;
      margin-right: 14px;
      flex-shrink: 0;
      overflow: hidden;
    }

    .avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 50%;
    }

    .user-info-main {
      flex: 1;
    }

    .user-name {
      font-size: 18px;
      font-weight: 700;
    }

    .user-email {
      font-size: 13px;
      color: #666;
      margin-top: 4px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .user-tags {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-top: 8px;
      font-size: 11px;
    }

    .tag-pill {
      padding: 3px 7px;
      border-radius: 999px;
      background: #fff6df;
      color: #d68b00;
      border: 1px solid #ffe2a6;
    }

    .tag-pill.secondary {
      background: #f0f3ff;
      color: #4253ff;
      border-color: #c7d0ff;
    }

    .profile-badge {
      font-size: 12px;
      color: #999;
    }

    /* Âø´ÈÄüÁªüËÆ° */
    .stats-row {
      display: flex;
      text-align: center;
      padding-top: 12px;
      margin-top: 12px;
      border-top: 1px solid #f0f0f0;
    }

    .stat-item {
      flex: 1;
      font-size: 12px;
    }

    .stat-label {
      color: #777;
    }

    .stat-value {
      font-weight: 700;
      font-size: 16px;
      margin-top: 4px;
      color: #222;
    }

    /* ÁôªÂΩïÂå∫ */
    .login-panel {
      margin: 6px 16px 0;
      padding: 14px 14px 12px;
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 6px 14px rgba(0, 0, 0, 0.08);
    }

    .login-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .login-subtitle {
      font-size: 12px;
      color: #777;
      margin-bottom: 12px;
    }

    .social-buttons {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .social-btn {
      width: 100%;
      border-radius: 999px;
      border: 1px solid #e1e1e1;
      background: #fff;
      padding: 8px 14px;
      font-size: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      cursor: pointer;
    }

    .social-btn span {
      flex: 1;
      text-align: center;
    }

    .social-icon {
      font-size: 18px;
    }

    .social-btn.google { border-color: #e4e4e4; }
    .social-btn.facebook { border-color: #3b5998; color: #3b5998; }
    .social-btn.apple {
      border-color: #000;
      color: #000;
      background: #fff;
    }

    /* ÂàÜÁªÑÊ†áÈ¢ò */
    .section-block {
      margin: 14px 12px 0;
      border-radius: 18px;
      overflow: hidden;
      background: #fff;
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.04);
    }

    .section-header {
      padding: 10px 14px 4px;
      font-size: 13px;
      font-weight: 600;
      color: #777;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .section-header span:last-child {
      font-size: 12px;
      color: #aaa;
    }

    .menu-list {
      padding: 4px 0 8px;
    }

    .menu-item {
      display: flex;
      align-items: center;
      padding: 10px 14px;
      font-size: 14px;
      cursor: pointer;
    }

    .menu-item + .menu-item {
      border-top: 1px solid #f3f3f3;
    }

    .menu-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .menu-icon {
      width: 24px;
      text-align: center;
      font-size: 18px;
    }

    .menu-title {
      font-size: 14px;
    }

    .menu-right {
      margin-left: auto;
      display: flex;
      align-items: center;
      font-size: 12px;
      color: #aaa;
      gap: 4px;
    }

    .badge {
      font-size: 11px;
      padding: 2px 6px;
      border-radius: 999px;
      background: #fff4e0;
      color: #c96a00;
      border: 1px solid #ffdda5;
    }

    /* Â∫ïÈÉ®ÂØºËà™Âç†‰ΩçÔºàÁªô AppMySite Â∫ïÊ†èÁïôÁ©∫Èó¥Áî®ÁöÑÔºâ */
    .bottom-safe {
      height: 72px;
    }

    @media (min-width: 480px) {
      .account-inner { margin-top: 10px; }
    }
  </style>
</head>
<body>
<div class="account-page">
  <div class="account-inner">

    <!-- È°∂ÈÉ® -->
    <div class="account-header">
      <div>
        <div class="account-title">My Account</div>
        <div class="account-subtitle">Manage orders, favorites & profile</div>
      </div>
    </div>

    <!-- ‰∏™‰∫∫‰ø°ÊÅØÂç°Áâá -->
    <div class="profile-card">
      <div class="profile-header">
        <div class="avatar" id="user-avatar-wrapper">
          <span id="user-initial">B</span>
        </div>
        <div class="user-info-main">
          <div class="user-name" id="user-name">Guest</div>
          <div class="user-email" id="user-email">Sign in to sync your orders</div>
          <div class="user-tags">
            <span class="tag-pill">Member</span>
            <span class="tag-pill secondary">Mobile App</span>
          </div>
        </div>
        <div class="profile-badge" id="profile-status">Not signed in</div>
      </div>

      <!-- quick stats -->
      <div class="stats-row">
        <div class="stat-item">
          <div class="stat-label">Orders</div>
          <div class="stat-value" id="stat-orders">0</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">Favorites</div>
          <div class="stat-value" id="stat-favs">0</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">Coupons</div>
          <div class="stat-value" id="stat-coupons">0</div>
        </div>
      </div>
    </div>

    <!-- ÁôªÂΩï / ‰∏âÊñπË¥¶Âè∑Âå∫Âüü -->
    <div class="login-panel" id="login-panel">
      <div class="login-title">Sign in or create your B1ing account</div>
      <div class="login-subtitle">
        Use Google or Facebook to quickly sign in and sync your orders & favorites.
      </div>
      <div class="social-buttons">
        <!-- Google buttonÂÆπÂô®ÔºöÁî± GIS Ê∏≤Êüì -->
        <div id="google-btn" class="social-btn google">
          <span>Continue with Google</span>
        </div>
        <!--button class="social-btn facebook" onclick="loginWithFacebook()">
          <span class="social-icon">üìò</span>
          <span>Continue with Facebook</span>
          <span></span>
        </button>
        --->
      </div>
    </div>

    <!-- Orders & After-sales -->
    <div class="section-block">
      <div class="section-header">
        <span>Orders & After-sales</span>
        <span>View all &gt;</span>
      </div>
      <div class="menu-list">
        <div class="menu-item" onclick="location.href='my_orders.html'">
          <div class="menu-left">
            <div class="menu-icon">üì¶</div>
            <div class="menu-title">My Orders</div>
          </div>
          <div class="menu-right">
            <span class="badge">New</span>
            <span>All statuses</span>
            <span>‚Ä∫</span>
          </div>
        </div>

        <div class="menu-item" onclick="openSection('address')">
          <div class="menu-left">
            <div class="menu-icon">üè†</div>
            <div class="menu-title">Shipping Address</div>
          </div>
          <div class="menu-right">
            <span>Manage</span>
            <span>‚Ä∫</span>
          </div>
        </div>

        <div class="menu-item" onclick="openSection('coupons')">
          <div class="menu-left">
            <div class="menu-icon">üéüÔ∏è</div>
            <div class="menu-title">Coupons</div>
          </div>
          <div class="menu-right">
            <span id="coupon-count">0 available</span>
            <span>‚Ä∫</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Favorites / Cart / Recently viewed -->
    <div class="section-block">
      <div class="section-header">
        <span>Shortcuts</span>
        <span>Personalized</span>
      </div>
      <div class="menu-list">
        <div class="menu-item" onclick="openSection('favorites')">
          <div class="menu-left">
            <div class="menu-icon">‚ù§Ô∏è</div>
            <div class="menu-title">My Favorites</div>
          </div>
          <div class="menu-right">
            <span>All saved items</span>
            <span>‚Ä∫</span>
          </div>
        </div>

        <div class="menu-item" onclick="openSection('cart')">
          <div class="menu-left">
            <div class="menu-icon">üõí</div>
            <div class="menu-title">My Cart</div>
          </div>
          <div class="menu-right">
            <span>Check out</span>
            <span>‚Ä∫</span>
          </div>
        </div>

        <div class="menu-item" onclick="openSection('history')">
          <div class="menu-left">
            <div class="menu-icon">üëÄ</div>
            <div class="menu-title">Recently Viewed</div>
          </div>
          <div class="menu-right">
            <span>Browse again</span>
            <span>‚Ä∫</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Settings & Sign out -->
    <div class="section-block">
      <div class="section-header">
        <span>Settings & Help</span>
        <span></span>
      </div>
      <div class="menu-list">
        <div class="menu-item" onclick="openSection('profile')">
          <div class="menu-left">
            <div class="menu-icon">üë§</div>
            <div class="menu-title">Profile & Preferences</div>
          </div>
          <div class="menu-right">
            <span>Edit</span>
            <span>‚Ä∫</span>
          </div>
        </div>

        <div class="menu-item" onclick="openSection('support')">
          <div class="menu-left">
            <div class="menu-icon">üí¨</div>
            <div class="menu-title">Customer Support</div>
          </div>
          <div class="menu-right">
            <span>Chat now</span>
            <span>‚Ä∫</span>
          </div>
        </div>

        <div class="menu-item" onclick="handleSignOut()">
          <div class="menu-left">
            <div class="menu-icon">üö™</div>
            <div class="menu-title">Sign out</div>
          </div>
          <div class="menu-right">
            <span>Current device</span>
            <span>‚Ä∫</span>
          </div>
        </div>
      </div>
    </div>

    <div class="bottom-safe"></div>
  </div>
</div>

<script>
  // ==== ÈÖçÁΩÆÔºöÊääËøôÈáåÊîπÊàê‰Ω†Ëá™Â∑±ÁöÑ App ‰ø°ÊÅØ ====
  const GOOGLE_CLIENT_ID = "874569690729-8davcc3gf01t5vb470dom6pn28hvihcq.apps.googleusercontent.com";
  const FB_APP_ID = "YOUR_FB_APP_ID"; // TODO: ÊõøÊç¢Êàê‰Ω†ÁöÑ Facebook App ID
 

  // ========== ÈÄöÁî® Profile Âä†ËΩΩ ==========
  function loadProfile() {
    const name = localStorage.getItem("user_name");
    const email = localStorage.getItem("user_email");
    const avatarUrl = localStorage.getItem("user_avatar");

    const displayName = name || "Guest";
    const displayEmail = email || "Sign in to sync your orders";

    document.getElementById("user-name").textContent = displayName;
    document.getElementById("user-email").textContent = displayEmail;

    const avatarWrapper = document.getElementById("user-avatar-wrapper");
    const initialEl = document.getElementById("user-initial");

    if (avatarUrl) {
      avatarWrapper.innerHTML = '<img src="' + avatarUrl + '" alt="avatar">';
    } else {
      avatarWrapper.innerHTML = '<span id="user-initial"></span>';
      const initial = displayName ? displayName.charAt(0).toUpperCase() : "B";
      document.getElementById("user-initial").textContent = initial;
    }

    const statusEl = document.getElementById("profile-status");
    const loginPanel = document.getElementById("login-panel");

    if (name && email) {
      statusEl.textContent = "Signed in";
      loginPanel.style.display = "none";
    } else {
      statusEl.textContent = "Not signed in";
      loginPanel.style.display = "block";
    }
  }

  function loadStats() {
    // ËøôÈáåÂèØ‰ª•Â∞ÜÊù•Êé•ÁúüÊ≠£ APIÔºåÁõÆÂâçÂÖàÁî®Êú¨Âú∞ÁºìÂ≠òÂÅöÊºîÁ§∫
    const orders = parseInt(localStorage.getItem("stat_orders") || "0", 10);
    const favs = parseInt(localStorage.getItem("stat_favs") || "0", 10);
    const coupons = parseInt(localStorage.getItem("stat_coupons") || "0", 10);

    document.getElementById("stat-orders").textContent = orders;
    document.getElementById("stat-favs").textContent = favs;
    document.getElementById("stat-coupons").textContent = coupons;
    document.getElementById("coupon-count").textContent = coupons + " available";
  }

  function openSection(key) {
    // ËøôÈáåÂÖàÁî® alertÔºåÂç†‰ΩçÔºåÂêéÈù¢‰Ω†ÂèØ‰ª•Êç¢ÊàêÂÆûÈôÖÈ°µÈù¢Ë∑≥ËΩ¨
    if (key === "favorites") {
      window.location.href = "favorites.html"; // TODO: ‰Ω†Ëá™Â∑±ÁöÑÊî∂ËóèÈ°µÈù¢
    } else if (key === "cart") {
      window.location.href = "cart.html"; // TODO: ‰Ω†ÁöÑË¥≠Áâ©ËΩ¶È°µÈù¢
    } else {
      alert("Open section: " + key + " (you can hook this to real pages)");
    }
  }

  function handleSignOut() {
    if (!localStorage.getItem("user_name") && !localStorage.getItem("user_email")) {
      alert("You are not signed in.");
      return;
    }
    if (confirm("Sign out from this device?")) {
      localStorage.removeItem("user_name");
      localStorage.removeItem("user_email");
      localStorage.removeItem("user_avatar");
      alert("You have been signed out.");
      loadProfile();
    }
  }

  // ========== Google Login ==========
  function parseJwt(token) {
    const base64Url = token.split(".")[1];
    const base64 = base64Url.replace(/-/g, "+").replace(/_/g, "/");
    const jsonPayload = decodeURIComponent(
      atob(base64)
        .split("")
        .map(function (c) {
          return "%" + ("00" + c.charCodeAt(0).toString(16)).slice(-2);
        })
        .join("")
    );
    return JSON.parse(jsonPayload);
  }

  function handleGoogleCredential(response) {
    try {
      const data = parseJwt(response.credential);
      const name = data.name || data.given_name || "Google User";
      const email = data.email || "";
      const picture = data.picture || "";

      localStorage.setItem("user_name", name);
      localStorage.setItem("user_email", email);
      if (picture) localStorage.setItem("user_avatar", picture);

      alert("Signed in with Google as " + name);
      loadProfile();
    } catch (e) {
      console.error(e);
      alert("Failed to parse Google login info.");
    }
  }

  function initGoogleLogin() {
    if (!window.google || !google.accounts || !google.accounts.id) return;
    google.accounts.id.initialize({
      client_id: GOOGLE_CLIENT_ID,
      callback: handleGoogleCredential,
      auto_select: false,
      cancel_on_tap_outside: true,
    });

    const btn = document.getElementById("google-btn");
    if (btn) {
      google.accounts.id.renderButton(btn, {
        type: "standard",
        theme: "outline",
        text: "continue_with",
        shape: "pill",
        width: 320,
      });
    }
  }

  // ========== Facebook Login ==========
  window.fbAsyncInit = function () {
    if (!FB_APP_ID || FB_APP_ID === "YOUR_FB_APP_ID") {
      console.warn("Facebook App ID not configured.");
      return;
    }
    FB.init({
      appId: FB_APP_ID,
      cookie: true,
      xfbml: false,
      version: "v21.0",
    });
  };

  function loginWithFacebook() {
    if (!FB_APP_ID || FB_APP_ID === "YOUR_FB_APP_ID") {
      alert("Please configure your Facebook App ID in my_account.html first.");
      return;
    }

    FB.login(
      function (response) {
        if (response.authResponse) {
          FB.api(
            "/me",
            { fields: "name,email,picture" },
            function (user) {
              const name = user.name || "Facebook User";
              const email = user.email || "";
              const picture = user.picture && user.picture.data && user.picture.data.url;

              localStorage.setItem("user_name", name);
              if (email) localStorage.setItem("user_email", email);
              if (picture) localStorage.setItem("user_avatar", picture);

              alert("Signed in with Facebook as " + name);
              loadProfile();
            }
          );
        } else {
          console.log("Facebook login cancelled.");
        }
      },
      { scope: "public_profile,email" }
    );
  }


  // ÂàùÂßãÂåñ
  window.onload = function () {
    loadProfile();
    loadStats();
  };
  

</script>
</body>
</html>
